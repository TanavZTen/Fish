<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Literature - Card Game</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const Users = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const Copy = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect>
                <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path>
            </svg>
        );

        const Check = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const Crown = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"></path>
            </svg>
        );

        const Trophy = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const Book = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
            </svg>
        );

        const SETS = [
          { name: 'Spades 2-7', cards: ['2‚ô†', '3‚ô†', '4‚ô†', '5‚ô†', '6‚ô†', '7‚ô†'] },
          { name: 'Spades 9-A', cards: ['9‚ô†', '10‚ô†', 'J‚ô†', 'Q‚ô†', 'K‚ô†', 'A‚ô†'] },
          { name: 'Hearts 2-7', cards: ['2‚ô•', '3‚ô•', '4‚ô•', '5‚ô•', '6‚ô•', '7‚ô•'] },
          { name: 'Hearts 9-A', cards: ['9‚ô•', '10‚ô•', 'J‚ô•', 'Q‚ô•', 'K‚ô•', 'A‚ô•'] },
          { name: 'Clubs 2-7', cards: ['2‚ô£', '3‚ô£', '4‚ô£', '5‚ô£', '6‚ô£', '7‚ô£'] },
          { name: 'Clubs 9-A', cards: ['9‚ô£', '10‚ô£', 'J‚ô£', 'Q‚ô£', 'K‚ô£', 'A‚ô£'] },
          { name: 'Diamonds 2-7', cards: ['2‚ô¶', '3‚ô¶', '4‚ô¶', '5‚ô¶', '6‚ô¶', '7‚ô¶'] },
          { name: 'Diamonds 9-A', cards: ['9‚ô¶', '10‚ô¶', 'J‚ô¶', 'Q‚ô¶', 'K‚ô¶', 'A‚ô¶'] },
          { name: 'Eights + Jokers', cards: ['8‚ô•', '8‚ô¶', '8‚ô†', '8‚ô£', 'RJ', 'BJ'] }
        ];

        const App = () => {
          const [view, setView] = useState('home');
          const [gameState, setGameState] = useState('lobby');
          const [roomCode, setRoomCode] = useState('');
          const [playerName, setPlayerName] = useState('');
          const [players, setPlayers] = useState([]);
          const [myHand, setMyHand] = useState([]);
          const [myId, setMyId] = useState('');
          const [currentTurn, setCurrentTurn] = useState('');
          const [selectedOpponent, setSelectedOpponent] = useState('');
          const [selectedCard, setSelectedCard] = useState('');
          const [gameLog, setGameLog] = useState([]);
          const [teams, setTeams] = useState({ team1: [], team2: [] });
          const [scores, setScores] = useState({ team1: 0, team2: 0 });
          const [showCallModal, setShowCallModal] = useState(false);
          const [callSetIndex, setCallSetIndex] = useState(0);
          const [callCards, setCallCards] = useState({});
          const [copied, setCopied] = useState(false);
          const [selectedTeam, setSelectedTeam] = useState('');
          const [showTeamSelect, setShowTeamSelect] = useState(false);

          useEffect(() => {
            const interval = setInterval(() => {
              if (roomCode && gameState !== 'lobby') {
                loadGame();
              }
            }, 2000);
            return () => clearInterval(interval);
          }, [roomCode, gameState]);

          const loadGame = () => {
            if (!roomCode) return;
            try {
              const game = localStorage.getItem(`game:${roomCode}`);
              if (game) {
                const data = JSON.parse(game);
                setPlayers(data.players || []);
                setCurrentTurn(data.currentTurn || '');
                setGameLog(data.gameLog || []);
                setTeams(data.teams || { team1: [], team2: [] });
                setScores(data.scores || { team1: 0, team2: 0 });
                
                if (data.started) {
                  setGameState('playing');
                }
                
                const me = data.players.find(p => p.id === myId);
                if (me) {
                  setMyHand(me.hand || []);
                }
              }
            } catch (e) {
              console.log('Error loading game:', e);
            }
          };

          const createRoom = () => {
            const code = Math.random().toString(36).substring(2, 8).toUpperCase();
            setRoomCode(code);
            const id = Date.now().toString();
            setMyId(id);
            setShowTeamSelect(true);
          };

          const confirmTeamAndCreate = () => {
            if (!selectedTeam) {
              alert('Please select a team!');
              return;
            }

            const initialGame = {
              players: [{ id: myId, name: playerName, hand: [] }],
              currentTurn: '',
              gameLog: [],
              teams: { 
                team1: selectedTeam === 'team1' ? [myId] : [], 
                team2: selectedTeam === 'team2' ? [myId] : [] 
              },
              scores: { team1: 0, team2: 0 },
              started: false
            };
            
            localStorage.setItem(`game:${roomCode}`, JSON.stringify(initialGame));
            setGameState('waiting');
            loadGame();
          };

          const joinRoom = () => {
            const game = localStorage.getItem(`game:${roomCode}`);
            if (!game) {
              alert('Room not found!');
              return;
            }
            
            const id = Date.now().toString();
            setMyId(id);
            setShowTeamSelect(true);
          };

          const confirmTeamAndJoin = () => {
            if (!selectedTeam) {
              alert('Please select a team!');
              return;
            }

            try {
              const game = localStorage.getItem(`game:${roomCode}`);
              const data = JSON.parse(game);
              
              if (data.started) {
                alert('Game already started!');
                return;
              }
              
              data.players.push({ id: myId, name: playerName, hand: [] });
              
              if (selectedTeam === 'team1') {
                data.teams.team1.push(myId);
              } else {
                data.teams.team2.push(myId);
              }
              
              localStorage.setItem(`game:${roomCode}`, JSON.stringify(data));
              setGameState('waiting');
              setShowTeamSelect(false);
              loadGame();
            } catch (e) {
              alert('Error joining room');
            }
          };

          const startGame = () => {
            if (players.length < 4) {
              alert('Need at least 4 players to start!');
              return;
            }

            if (teams.team1.length === 0 || teams.team2.length === 0) {
              alert('Both teams need at least one player!');
              return;
            }

            const deck = [];
            SETS.forEach(set => {
              deck.push(...set.cards);
            });

            for (let i = deck.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [deck[i], deck[j]] = [deck[j], deck[i]];
            }

            const cardsPerPlayer = Math.floor(deck.length / players.length);
            const updatedPlayers = players.map((p, idx) => ({
              ...p,
              hand: deck.slice(idx * cardsPerPlayer, (idx + 1) * cardsPerPlayer)
            }));

            const gameData = {
              players: updatedPlayers,
              currentTurn: updatedPlayers[0].id,
              gameLog: ['Game started!'],
              teams,
              scores: { team1: 0, team2: 0 },
              started: true
            };

            localStorage.setItem(`game:${roomCode}`, JSON.stringify(gameData));
            setGameState('playing');
            loadGame();
          };

          const getAskableCards = () => {
            if (!myHand.length) return [];
            
            const askable = [];
            
            myHand.forEach(card => {
              const set = SETS.find(s => s.cards.includes(card));
              if (set) {
                set.cards.forEach(c => {
                  if (!myHand.includes(c) && !askable.includes(c)) {
                    askable.push(c);
                  }
                });
              }
            });
            
            return askable;
          };

          const askForCard = () => {
            if (!selectedOpponent || !selectedCard) {
              alert('Select an opponent and a card!');
              return;
            }

            try {
              const game = localStorage.getItem(`game:${roomCode}`);
              const data = JSON.parse(game);
              
              const opponent = data.players.find(p => p.id === selectedOpponent);
              const me = data.players.find(p => p.id === myId);
              
              const hasCard = opponent.hand.includes(selectedCard);
              
              if (hasCard) {
                opponent.hand = opponent.hand.filter(c => c !== selectedCard);
                me.hand.push(selectedCard);
                data.gameLog.unshift(`${playerName} asked ${opponent.name} for ${selectedCard} - SUCCESS! Goes again.`);
              } else {
                const opponentTeam = data.teams.team1.includes(opponent.id) ? 'team1' : 'team2';
                const nextPlayer = data.teams[opponentTeam][0];
                data.currentTurn = nextPlayer;
                data.gameLog.unshift(`${playerName} asked ${opponent.name} for ${selectedCard} - FAILED. Turn passes to ${opponentTeam === 'team1' ? 'Team 1' : 'Team 2'}.`);
              }
              
              localStorage.setItem(`game:${roomCode}`, JSON.stringify(data));
              setSelectedCard('');
              setSelectedOpponent('');
              loadGame();
            } catch (e) {
              alert('Error making move');
            }
          };

          const openCallModal = () => {
            setShowCallModal(true);
            setCallCards({});
          };

          const submitCall = () => {
            const set = SETS[callSetIndex];
            const calledCards = Object.values(callCards);
            
            if (calledCards.length !== set.cards.length) {
              alert('You must assign all cards in the set!');
              return;
            }

            try {
              const game = localStorage.getItem(`game:${roomCode}`);
              const data = JSON.parse(game);
              
              let correct = true;
              const actualLocations = {};
              
              set.cards.forEach(card => {
                const holder = data.players.find(p => p.hand.includes(card));
                if (holder) {
                  actualLocations[card] = holder.id;
                }
              });
              
              set.cards.forEach(card => {
                if (callCards[card] !== actualLocations[card]) {
                  correct = false;
                }
              });
              
              const myTeam = data.teams.team1.includes(myId) ? 'team1' : 'team2';
              const opponentTeam = myTeam === 'team1' ? 'team2' : 'team1';
              
              if (correct) {
                data.scores[myTeam]++;
                data.gameLog.unshift(`${playerName} correctly called ${set.name}! ${myTeam === 'team1' ? 'Team 1' : 'Team 2'} scores!`);
                
                set.cards.forEach(card => {
                  data.players.forEach(p => {
                    p.hand = p.hand.filter(c => c !== card);
                  });
                });
              } else {
                data.scores[opponentTeam]++;
                data.gameLog.unshift(`${playerName} INCORRECTLY called ${set.name}! ${opponentTeam === 'team1' ? 'Team 1' : 'Team 2'} gets the set!`);
                
                set.cards.forEach(card => {
                  data.players.forEach(p => {
                    p.hand = p.hand.filter(c => c !== card);
                  });
                });
              }
              
              localStorage.setItem(`game:${roomCode}`, JSON.stringify(data));
              setShowCallModal(false);
              loadGame();
              
              if (data.scores.team1 + data.scores.team2 === 9) {
                setTimeout(() => {
                  alert(`Game Over! ${data.scores.team1 > data.scores.team2 ? 'Team 1' : 'Team 2'} wins ${data.scores.team1}-${data.scores.team2}!`);
                }, 100);
              }
            } catch (e) {
              alert('Error submitting call');
            }
          };

          const copyRoomCode = () => {
            navigator.clipboard.writeText(roomCode);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
          };

          if (view === 'home') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-green-700 via-green-800 to-green-900">
                <div className="container mx-auto px-4 py-16">
                  <div className="text-center mb-16">
                    <Trophy className="w-24 h-24 mx-auto mb-6 text-yellow-400" />
                    <h1 className="text-6xl font-bold text-white mb-4">Literature</h1>
                    <p className="text-2xl text-green-100">The Strategic Card Game</p>
                  </div>

                  <div className="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl p-8 mb-8">
                    <div className="grid md:grid-cols-2 gap-8 mb-8">
                      <button
                        onClick={() => setView('play')}
                        className="bg-gradient-to-br from-green-600 to-green-700 text-white py-8 rounded-2xl font-bold text-2xl hover:from-green-700 hover:to-green-800 transform hover:scale-105 transition-all shadow-lg"
                      >
                        <Trophy className="w-12 h-12 mx-auto mb-3" />
                        Play Now
                      </button>
                      
                      <button
                        onClick={() => setView('rules')}
                        className="bg-gradient-to-br from-blue-600 to-blue-700 text-white py-8 rounded-2xl font-bold text-2xl hover:from-blue-700 hover:to-blue-800 transform hover:scale-105 transition-all shadow-lg"
                      >
                        <Book className="w-12 h-12 mx-auto mb-3" />
                        How to Play
                      </button>
                    </div>

                    <div className="bg-green-50 rounded-xl p-6">
                      <h3 className="font-bold text-xl mb-3">Quick Overview</h3>
                      <ul className="space-y-2 text-gray-700">
                        <li>‚úì 2 teams compete to collect sets of 6 cards</li>
                        <li>‚úì Ask opponents for specific cards to build your sets</li>
                        <li>‚úì Call complete sets to score points</li>
                        <li>‚úì First team to 5 sets wins!</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (view === 'rules') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-700 via-blue-800 to-blue-900 p-4">
                <div className="max-w-4xl mx-auto">
                  <button
                    onClick={() => setView('home')}
                    className="bg-white text-blue-700 px-6 py-3 rounded-lg font-semibold mb-6 hover:bg-blue-50"
                  >
                    ‚Üê Back to Home
                  </button>

                  <div className="bg-white rounded-3xl shadow-2xl p-8">
                    <h1 className="text-4xl font-bold mb-6 text-center">How to Play Literature</h1>

                    <div className="space-y-6">
                      <section>
                        <h2 className="text-2xl font-bold mb-3 text-blue-700">Setup</h2>
                        <p className="mb-2">Literature is played with 54 cards: a standard deck plus 2 jokers.</p>
                        <ul className="list-disc list-inside space-y-1 text-gray-700">
                          <li>2 teams of 2-4 players each</li>
                          <li>All 54 cards are dealt to players</li>
                          <li>Players can only see their own cards</li>
                          <li><strong>No communication allowed</strong> - no hints, signals, or strategy talk</li>
                        </ul>
                      </section>

                      <section>
                        <h2 className="text-2xl font-bold mb-3 text-blue-700">The 9 Sets</h2>
                        <div className="grid md:grid-cols-2 gap-3">
                          {SETS.map((set, i) => (
                            <div key={i} className="bg-gray-50 p-3 rounded-lg">
                              <div className="font-semibold mb-1">{set.name}</div>
                              <div className="text-sm text-gray-600">{set.cards.join(', ')}</div>
                            </div>
                          ))}
                        </div>
                      </section>

                      <section>
                        <h2 className="text-2xl font-bold mb-3 text-blue-700">How Turns Work</h2>
                        <div className="space-y-3">
                          <div className="bg-green-50 p-4 rounded-lg">
                            <h3 className="font-bold mb-2">On Your Turn:</h3>
                            <ol className="list-decimal list-inside space-y-1">
                              <li>Pick one opponent from the other team</li>
                              <li>Ask for one specific card</li>
                              <li><strong>Important:</strong> You can only ask for a card if your team already has at least one card from that set</li>
                            </ol>
                          </div>

                          <div className="bg-blue-50 p-4 rounded-lg">
                            <h3 className="font-bold mb-2">If They Have It:</h3>
                            <p>They give you the card and you go again - keep asking!</p>
                          </div>

                          <div className="bg-red-50 p-4 rounded-lg">
                            <h3 className="font-bold mb-2">If They Don't Have It:</h3>
                            <p>Your turn ends immediately and it becomes <strong>their team's turn</strong></p>
                          </div>
                        </div>
                      </section>

                      <section>
                        <h2 className="text-2xl font-bold mb-3 text-blue-700">Calling a Set</h2>
                        <p className="mb-3">Instead of asking for a card, you can call a complete set:</p>
                        <ul className="list-disc list-inside space-y-1 mb-3 text-gray-700">
                          <li>Name all 6 cards and which player holds each card</li>
                          <li>You must get every single card location correct</li>
                        </ul>
                        
                        <div className="bg-yellow-50 border-2 border-yellow-400 p-4 rounded-lg">
                          <p className="font-bold mb-2">‚ö†Ô∏è High Risk, High Reward:</p>
                          <p className="mb-1">‚úÖ If correct: Your team scores 1 point, set is removed from play</p>
                          <p>‚ùå If wrong: The other team automatically gets that entire set!</p>
                        </div>
                      </section>

                      <section>
                        <h2 className="text-2xl font-bold mb-3 text-blue-700">Winning</h2>
                        <p>The game ends when all 9 sets are claimed. The team with the most sets wins!</p>
                      </section>

                      <section className="bg-gray-50 p-6 rounded-xl">
                        <h2 className="text-2xl font-bold mb-3">Strategy Tips</h2>
                        <ul className="space-y-2 text-gray-700">
                          <li>üìù <strong>Track everything:</strong> Remember who asks for what cards</li>
                          <li>üß† <strong>Deduce locations:</strong> If someone stops asking for a set, they probably completed it</li>
                          <li>‚ö° <strong>Time your calls:</strong> Don't call too early - gather more information first</li>
                          <li>üéØ <strong>Focus on the 8s + Jokers:</strong> This is often the hardest set to track</li>
                        </ul>
                      </section>
                    </div>

                    <button
                      onClick={() => setView('play')}
                      className="w-full mt-8 bg-gradient-to-r from-green-600 to-green-700 text-white py-4 rounded-xl font-bold text-xl hover:from-green-700 hover:to-green-800"
                    >
                      Ready to Play!
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          const myTeam = teams.team1.includes(myId) ? 'team1' : 'team2';
          const isMyTurn = currentTurn === myId;

          if (showTeamSelect) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-green-700 to-green-900 flex items-center justify-center p-4">
                <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                  <h2 className="text-2xl font-bold text-center mb-6">Choose Your Team</h2>
                  
                  <div className="space-y-4">
                    <button
                      onClick={() => setSelectedTeam('team1')}
                      className={`w-full p-6 rounded-lg border-4 transition-all ${
                        selectedTeam === 'team1' 
                          ? 'border-blue-600 bg-blue-50' 
                          : 'border-gray-300 bg-white hover:border-blue-400'
                      }`}
                    >
                      <div className="text-2xl font-bold text-blue-600 mb-2">Team 1</div>
                      <div className="text-sm text-gray-600">Join the Blue Team</div>
                    </button>
                    
                    <button
                      onClick={() => setSelectedTeam('team2')}
                      className={`w-full p-6 rounded-lg border-4 transition-all ${
                        selectedTeam === 'team2' 
                          ? 'border-red-600 bg-red-50' 
                          : 'border-gray-300 bg-white hover:border-red-400'
                      }`}
                    >
                      <div className="text-2xl font-bold text-red-600 mb-2">Team 2</div>
                      <div className="text-sm text-gray-600">Join the Red Team</div>
                    </button>
                  </div>
                  
                  <button
                    onClick={gameState === 'lobby' ? confirmTeamAndCreate : confirmTeamAndJoin}
                    disabled={!selectedTeam}
                    className="w-full mt-6 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 disabled:bg-gray-300"
                  >
                    Confirm Team
                  </button>
                  
                  <button
                    onClick={() => {
                      setShowTeamSelect(false);
                      setSelectedTeam('');
                      setRoomCode('');
                      setMyId('');
                      setView('home');
                    }}
                    className="w-full mt-2 bg-gray-300 text-gray-700 py-2 rounded-lg font-semibold hover:bg-gray-400"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            );
          }

          if (gameState === 'lobby') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-green-700 to-green-900 flex items-center justify-center p-4">
                <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                  <button
                    onClick={() => setView('home')}
                    className="mb-4 text-gray-600 hover:text-gray-800"
                  >
                    ‚Üê Back
                  </button>
                  
                  <div className="text-center mb-8">
                    <Trophy className="w-16 h-16 mx-auto mb-4 text-yellow-600" />
                    <h1 className="text-3xl font-bold text-gray-800 mb-2">Literature</h1>
                    <p className="text-gray-600">9 Set Variant</p>
                  </div>
                  
                  <input
                    type="text"
                    placeholder="Your Name"
                    value={playerName}
                    onChange={(e) => setPlayerName(e.target.value)}
                    className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg mb-4 focus:
